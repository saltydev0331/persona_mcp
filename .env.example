# Persona MCP Server - Configuration Template
# ============================================
# Copy this file to .env and customize values for your deployment.
# All values shown are defaults and can be omitted if unchanged.

# ==========================================
# SERVER CONFIGURATION
# ==========================================

# WebSocket server host and port
SERVER_HOST=localhost
SERVER_PORT=8000

# Enable debug mode for development (additional logging and error details)
DEBUG_MODE=false

# WebSocket connection timeout (seconds)
WEBSOCKET_TIMEOUT=300

# Maximum concurrent WebSocket connections
MAX_CONNECTIONS=100


# ==========================================
# OLLAMA LLM CONFIGURATION
# ==========================================

# Ollama API endpoint
OLLAMA_HOST=http://localhost:11434

# Default language model to use
DEFAULT_MODEL=llama3.1:8b

# Request timeout for Ollama API calls (seconds)
OLLAMA_TIMEOUT=60

# Maximum retry attempts for failed requests
OLLAMA_MAX_RETRIES=3

# Extended timeout for long requests (seconds)
OLLAMA_REQUEST_TIMEOUT=120


# ==========================================
# SESSION MANAGEMENT
# ==========================================

# Maximum messages kept in active conversation context
MAX_CONTEXT_MESSAGES=20

# Threshold for context summarization (number of messages)
CONTEXT_SUMMARY_THRESHOLD=50

# Session expiration time (hours)
SESSION_TIMEOUT_HOURS=24

# Simulation tick interval for background processing (seconds)
TICK_INTERVAL_SECONDS=30

# Maximum concurrent conversations in simulation mode
MAX_CONCURRENT_CONVERSATIONS=5


# ==========================================
# MEMORY SYSTEM CONFIGURATION
# ==========================================

# Importance scoring ranges (0.0-1.0)
MEMORY_IMPORTANCE_MIN=0.51
MEMORY_IMPORTANCE_MAX=0.80
MEMORY_IMPORTANCE_THRESHOLD=0.6

# Importance scoring weights (must sum to 1.0)
MEMORY_CONTENT_WEIGHT=0.3        # Content analysis weight
MEMORY_ENGAGEMENT_WEIGHT=0.2     # User engagement signals
MEMORY_PERSONA_WEIGHT=0.15       # Persona interest alignment
MEMORY_TEMPORAL_WEIGHT=0.05      # Time-based significance
MEMORY_RELATIONSHIP_WEIGHT=0.1   # Social relationship factors
MEMORY_RECENCY_WEIGHT=0.2        # Recent interaction bonus

# Memory collection limits and pruning
MAX_MEMORIES_PER_PERSONA=1000    # Maximum memories per persona
PRUNING_THRESHOLD=900            # Start pruning at this count
MEMORY_MIN_SAFE_COUNT=10         # Never prune below this count
MEMORY_MAX_PRUNE_PERCENT=0.25    # Maximum 25% pruned per operation
MEMORY_PRUNE_BATCH_SIZE=5        # Process memories in batches

# Memory decay system
MEMORY_DECAY_MODE=exponential    # Decay algorithm: linear, exponential, logarithmic, access_based
MEMORY_DECAY_RATE=0.1            # Decay rate multiplier
MEMORY_DECAY_INTERVAL_MINUTES=60 # How often to run decay process
MEMORY_DECAY_MIN_IMPORTANCE=0.1  # Minimum importance after decay
MEMORY_DECAY_ENABLED=true        # Enable automatic memory decay

# Auto-pruning configuration
MEMORY_ENABLE_AUTO_PRUNING=true           # Enable automatic pruning
MEMORY_AUTO_PRUNE_THRESHOLD=1000          # Auto-prune when reaching this count
MEMORY_AUTO_PRUNE_IMPORTANCE_THRESHOLD=0.3 # Only prune memories below this importance

# Performance optimization
MEMORY_BATCH_SIZE=50                      # Memory processing batch size
MEMORY_ASYNC_PROCESSING=true              # Enable asynchronous processing
MEMORY_CONNECTION_POOL_SIZE=5             # Database connection pool size
MEMORY_MAX_PERSONAS_PER_CYCLE=5           # Personas processed per decay cycle
MEMORY_MAX_MEMORIES_PER_BATCH=100         # Maximum memories updated per batch


# ==========================================
# PERSONA DEFAULTS
# ==========================================

# Default persona attributes (1-20 scale)
PERSONA_DEFAULT_CHARISMA=10
PERSONA_DEFAULT_INTELLIGENCE=10
PERSONA_DEFAULT_SOCIAL_RANK=commoner

# Default interaction state values
PERSONA_DEFAULT_INTEREST_LEVEL=50         # Interest in conversations (0-100)
PERSONA_DEFAULT_INTERACTION_FATIGUE=0     # Starting fatigue level (0-100)
PERSONA_DEFAULT_AVAILABLE_TIME=300        # Available conversation time (seconds)
PERSONA_DEFAULT_SOCIAL_ENERGY=100         # Social energy level (0-150)
PERSONA_DEFAULT_COOLDOWN_SECONDS=300      # Cooldown between conversations

# Conversation scoring thresholds (0-100 scale)
PERSONA_CONTINUE_THRESHOLD=40             # Minimum score to continue conversation
PERSONA_HIGH_CONTINUE_SCORE=70            # Score considered satisfying
PERSONA_LOW_CONTINUE_SCORE=30             # Score considered unsatisfying

# Resource constraint thresholds
PERSONA_MIN_TIME_THRESHOLD=60             # Minimum time to start conversation (seconds)
PERSONA_LOW_TOKEN_BUDGET=100              # Low token budget threshold
PERSONA_LOW_SOCIAL_ENERGY=30              # Low social energy threshold

# Cooldown multipliers for conversation outcomes
PERSONA_SATISFYING_MULTIPLIER=0.5         # Reduce cooldown for satisfying conversations
PERSONA_UNSATISFYING_MULTIPLIER=2.0       # Increase cooldown for unsatisfying conversations
PERSONA_BASE_COOLDOWN_SECONDS=300         # Base cooldown period


# ==========================================
# CONVERSATION SCORING SYSTEM
# ==========================================

# Continue score component maximums (0-100 scale)
CONVERSATION_MAX_TIME_SCORE=30.0          # Time pressure component
CONVERSATION_MAX_TOPIC_SCORE=25.0         # Topic alignment component
CONVERSATION_MAX_SOCIAL_SCORE=20.0        # Social compatibility component
CONVERSATION_MAX_RESOURCE_SCORE=10.0      # Resource availability component
CONVERSATION_MAX_FATIGUE_PENALTY=15.0     # Fatigue penalty maximum
CONVERSATION_MAX_HISTORY_MODIFIER=15.0    # Relationship history modifier

# Time pressure decay rates (score decay per second)
CONVERSATION_URGENT_DECAY_RATE=2.0        # Urgent priority decay
CONVERSATION_IMPORTANT_DECAY_RATE=10.0    # Important priority decay
CONVERSATION_CASUAL_DECAY_RATE=30.0       # Casual priority decay

# Social status compatibility scoring (0-10 scale)
CONVERSATION_SAME_STATUS_COMPATIBILITY=8.0      # Same social rank
CONVERSATION_ADJACENT_STATUS_COMPATIBILITY=6.0  # Adjacent social ranks
CONVERSATION_DISTANT_STATUS_COMPATIBILITY=2.0   # Distant social ranks
CONVERSATION_DEFAULT_STATUS_COMPATIBILITY=4.0   # Default compatibility
CONVERSATION_LARGE_STATUS_GAP_THRESHOLD=3       # Threshold for large status gaps


# ==========================================
# DATABASE CONFIGURATION
# ==========================================

# Database file paths
DATABASE_PATH=data/persona_memory.db      # SQLite database file
CHROMADB_PATH=data/chromadb              # ChromaDB vector database directory

# Database optimization
DATABASE_ENABLE_WAL_MODE=true            # Enable SQLite WAL mode for performance
DATABASE_CONNECTION_TIMEOUT=30           # Connection timeout (seconds)
DATABASE_BACKUP_INTERVAL_HOURS=24        # Automatic backup interval


# ==========================================
# SIMULATION CONFIGURATION
# ==========================================

# Virtual environment settings for testing
SIMULATION_ROOM_NAME="The Debug Tavern"
SIMULATION_ROOM_DESCRIPTION="A cozy virtual tavern for testing persona interactions"

# Default conversation topics (comma-separated)
SIMULATION_DEFAULT_TOPICS=gossip,travel,magic,stories,local_news

# Simulation dynamics
SIMULATION_ENERGY_REGEN_RATE=2           # Energy regeneration per tick
SIMULATION_MAX_CONCURRENT_CONVERSATIONS=3 # Maximum simultaneous conversations